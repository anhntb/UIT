CREATE DATABASE QLKB;
USE QLKB;

CREATE TABLE BACSI (
    MABS CHAR(4) PRIMARY KEY,
    TENBS VARCHAR(20)
);

CREATE TABLE BENHNHAN (
    MABN CHAR(4) PRIMARY KEY,
    TENBN VARCHAR(20),
    NGAYSINH DATE,
    DCHI VARCHAR(50),
    DTHOAI VARCHAR(10),
    GIOITINH BOOLEAN
);

CREATE TABLE DICHVU (
    MADV CHAR(6) PRIMARY KEY,
    TENDV VARCHAR(50),
    DONGIA INT
);

CREATE TABLE KHAMBENH (
    MAKHAM CHAR(6) PRIMARY KEY,
    MABN CHAR(4),
    MABS CHAR(4),
    NGAYKHAM DATE,
    YEUCAUKHAM VARCHAR(50),
    KETLUAN VARCHAR(100),
    THANHTOAN BOOLEAN,
    FOREIGN KEY (MABN) REFERENCES BENHNHAN(MABN),
    FOREIGN KEY (MABS) REFERENCES BACSI(MABS)
);

CREATE TABLE THUPHI (
    MAKB CHAR(6),
    MADV CHAR(6),
    SOLUONG INT,
    THANHTIEN BIGINT,
    FOREIGN KEY (MAKB) REFERENCES KHAMBENH(MAKHAM),
    FOREIGN KEY (MADV) REFERENCES DICHVU(MADV)
);

-- DỮ LIỆU MẪU
INSERT INTO BACSI (MABS, TENBS) VALUES
('BS01', 'Nguyen Van A'),
('BS02', 'Le Thi B'),
('BS03', 'Tran Van C');

INSERT INTO BENHNHAN (MABN, TENBN, NGAYSINH, DCHI, DTHOAI, GIOITINH) VALUES
('BN01', 'Pham Thi D', '1990-05-10', '123 Duong 1, Q1', '0909123456', TRUE),
('BN02', 'Nguyen Van E', '1985-12-20', '456 Duong 2, Q3', '0911222333', FALSE),
('BN03', 'Le Thi F', '2000-08-15', '789 Duong 3, Q5', '0922333444', TRUE);

INSERT INTO KHAMBENH (MAKHAM, MABN, MABS, NGAYKHAM, YEUCAUKHAM, KETLUAN, THANHTOAN) VALUES
('KB001', 'BN01', 'BS01', '2024-06-01', 'Khám họng', 'Viêm họng cấp', FALSE),
('KB002', 'BN02', 'BS02', '2024-06-02', 'Khám tai', 'Viêm tai ngoài', TRUE),
('KB003', 'BN03', 'BS03', '2024-06-03', 'Khám mũi', 'Viêm xoang', FALSE);

INSERT INTO DICHVU (MADV, TENDV, DONGIA) VALUES
('DV001', 'Dịch vụ A', 30000),
('DV002', 'Dịch vụ B', 50000),
('DV003', 'Dịch vụ C', 20000);

INSERT INTO THUPHI (MAKB, MADV, SOLUONG, THANHTIEN) VALUES
('KB001', 'DV001', 1, 30000),
('KB001', 'DV002', 2, 100000),
('KB002', 'DV002', 1, 50000),
('KB003', 'DV003', 3, 60000);

-- VIEW
SELECT * FROM THUPHI

